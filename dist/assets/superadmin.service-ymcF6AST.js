var g=Object.defineProperty;var f=(d,s,e)=>s in d?g(d,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[s]=e;var m=(d,s,e)=>f(d,typeof s!="symbol"?s+"":s,e);import{T as c}from"./index-Bqden_Qr.js";class h{constructor(){m(this,"_mockTenants",[{ID:1,FullName:"Naresh V",Email:"nareshvn4n@gmail.com",PasswordHash:"$2a$10$Q4IcyohhMOT49iyx0nRYqOaIVnZrh0b7nYn9CHZsiQEbV1rB6Rz4q",Phone:null,RoleID:2,Role:{ID:0,RoleName:"templeadmin",Description:"Temple Administrator",CanRegisterPublicly:!0,CreatedAt:"2025-01-01T00:00:00Z",UpdatedAt:"2025-01-01T00:00:00Z"},EntityID:null,Status:"pending",EmailVerified:!1,EmailVerifiedAt:null,CreatedAt:"2025-07-12T17:00:16.325394Z",UpdatedAt:"2025-07-12T17:00:16.325394Z",DeletedAt:null},{ID:2,FullName:"GANESH",Email:"ganesh123@gmail.com",PasswordHash:"$2a$10$qvfEW9znvJEH19YDGiTyROSmTM9nzPjtpHXL/MDZ/3NoDqTsW8O5q",Phone:null,RoleID:2,Role:{ID:0,RoleName:"templeadmin",Description:"Temple Administrator",CanRegisterPublicly:!0,CreatedAt:"2025-01-01T00:00:00Z",UpdatedAt:"2025-01-01T00:00:00Z"},EntityID:null,Status:"pending",EmailVerified:!1,EmailVerifiedAt:null,CreatedAt:"2025-07-12T17:28:03.293811Z",UpdatedAt:"2025-07-12T17:28:03.293811Z",DeletedAt:null},{ID:3,FullName:"Sharath Kumar",Email:"sharath@example.com",PasswordHash:"$2a$10$Q4IcyohhMOT49iyx0nRYqOaIVnZrh0b7nYn9CHZsiQEbV1rB6Rz4q",Phone:"9876543210",RoleID:2,Role:{ID:0,RoleName:"templeadmin",Description:"Temple Administrator",CanRegisterPublicly:!0,CreatedAt:"2025-01-01T00:00:00Z",UpdatedAt:"2025-01-01T00:00:00Z"},EntityID:null,Status:"approved",EmailVerified:!0,EmailVerifiedAt:"2025-07-10T10:00:00Z",CreatedAt:"2025-07-10T10:00:00Z",UpdatedAt:"2025-07-10T10:00:00Z",DeletedAt:null},{ID:4,FullName:"Rajesh K",Email:"rajesh@example.com",PasswordHash:"$2a$10$Q4IcyohhMOT49iyx0nRYqOaIVnZrh0b7nYn9CHZsiQEbV1rB6Rz4q",Phone:"8765432109",RoleID:2,Role:{ID:0,RoleName:"templeadmin",Description:"Temple Administrator",CanRegisterPublicly:!0,CreatedAt:"2025-01-01T00:00:00Z",UpdatedAt:"2025-01-01T00:00:00Z"},EntityID:null,Status:"rejected",EmailVerified:!1,EmailVerifiedAt:null,CreatedAt:"2025-07-09T15:30:00Z",UpdatedAt:"2025-07-09T17:45:00Z",DeletedAt:null}]);this.baseURL="/v1/superadmin",this.pendingRequests=new Map}async getTenantsForSelection(){var s;try{console.log("Service: Fetching tenants for selection...");const e=await c.get(`${this.baseURL}/tenants/selection`);if(console.log("Service: Tenants selection response:",e),e&&e.data&&e.data.length>0?console.log("First tenant raw data:",JSON.stringify(e.data[0],null,2)):Array.isArray(e)&&e.length>0&&console.log("First tenant raw data (direct array):",JSON.stringify(e[0],null,2)),e&&e.data&&Array.isArray(e.data)){const a=e.data.map(t=>(console.log(`Processing tenant ${t.id}: temple_name=${t.temple_name}, templeName=${t.templeName}, location=${t.location}, temple_place=${t.temple_place}`),{id:t.id||t.ID,name:t.name||t.full_name||t.fullName||t.Name||"Unknown Tenant",email:t.email||t.Email||"",templeName:t.temple_name||t.templeName||"",location:t.location||t.temple_place||"",status:(t.status||t.Status||"active").toLowerCase(),templesCount:t.temples_count||t.templesCount||0,imageUrl:t.image_url||t.imageUrl||null,temple:{name:t.temple_name||t.templeName||"",address:t.location||t.temple_place||""}}));return console.log("Service: Processed tenants for selection:",a),{success:!0,data:a,message:"Tenants fetched successfully"}}else if(Array.isArray(e))return{success:!0,data:e.map(t=>(console.log(`Processing tenant ${t.id} (direct array): temple_name=${t.temple_name}, templeName=${t.templeName}, location=${t.location}, temple_place=${t.temple_place}`),{id:t.id||t.ID,name:t.name||t.full_name||t.fullName||t.Name||"Unknown Tenant",email:t.email||t.Email||"",templeName:t.temple_name||t.templeName||"",location:t.location||t.temple_place||"",status:(t.status||t.Status||"active").toLowerCase(),templesCount:t.temples_count||t.templesCount||0,imageUrl:t.image_url||t.imageUrl||null,temple:{name:t.temple_name||t.templeName||"",address:t.location||t.temple_place||""}})),message:"Tenants fetched successfully"};return console.warn("Service: Unexpected response format for tenant selection"),{success:!1,data:[],message:"Unexpected response format"}}catch(e){return console.error("Service: Error fetching tenants for selection:",e),((s=e.response)==null?void 0:s.status)===404?(console.warn("Tenants selection endpoint not found, using mock data"),{success:!0,data:this.getMockTenantsForSelection(),message:"Mock tenants loaded (API endpoint not available)"}):{success:!1,data:[],message:e.message||"Failed to fetch tenants for selection"}}}async getTenantDetails(s){try{console.log(`Service: Fetching tenant details for ID ${s}`);try{const e=await c.get(`${this.baseURL}/tenants/${s}`);if(console.log("Service: Tenant details response:",e),e&&e.data)return console.log("Retrieved temple details for tenant:",e.data),{success:!0,data:e.data}}catch(e){console.warn("Primary tenant details endpoint failed:",e);try{const a=await c.get(`${this.baseURL}/tenant-details/${s}`);if(a&&a.data)return{success:!0,data:{temple_details:a.data}}}catch(a){console.warn("Fallback endpoint failed too:",a)}}return console.log("Using mock data for tenant details"),{success:!0,data:this.getMockTenantDetails(s)}}catch(e){return console.error(`Service: Error fetching tenant details for ID ${s}:`,e),{success:!1,message:e.message}}}getMockTenantDetails(s){const e=[{name:"Sri Krishna Temple",place:"Bengaluru, Karnataka"},{name:"Ganesh Temple",place:"Mumbai, Maharashtra"},{name:"Meenakshi Temple",place:"Madurai, Tamil Nadu"},{name:"Jagannath Temple",place:"Puri, Odisha"},{name:"Kashi Vishwanath",place:"Varanasi, Uttar Pradesh"}],a=s%e.length,t=e[a];return{temple_details:{temple_name:t.name,temple_place:t.place,temple_address:`${123+s} Temple Street, ${t.place.split(",")[0]}`,temple_phone_no:`+91 98765${1e4+Number(s)}`,temple_description:`A beautiful ${t.name} dedicated to devotional services.`}}}async batchFetchTenantDetails(s){console.log(`Service: Batch fetching details for ${s.length} tenants`);const e={},a=3,t=1e3;for(let n=0;n<s.length;n+=a){const o=s.slice(n,n+a);console.log(`Processing batch ${Math.floor(n/a)+1}: ${o}`);const r=o.map(async l=>{try{const i=await this.getTenantDetails(l);i.success&&(e[l]=i.data)}catch(i){console.warn(`Error fetching details for tenant ${l}:`,i)}});await Promise.all(r),n+a<s.length&&(console.log(`Waiting ${t}ms before next batch...`),await new Promise(l=>setTimeout(l,t)))}return e}formatLocationForSelection(s){var n,o,r,l,i,p;const e=s.city||s.City||((n=s.temple)==null?void 0:n.city)||((o=s.Temple)==null?void 0:o.city)||"",a=s.state||s.State||((r=s.temple)==null?void 0:r.state)||((l=s.Temple)==null?void 0:l.state)||"",t=s.address||s.Address||((i=s.temple)==null?void 0:i.address)||((p=s.Temple)==null?void 0:p.address)||"";if(e&&a)return`${e}, ${a}`;if(t){const u=t.split(",");return u.length>=2?`${u[u.length-2].trim()}, ${u[u.length-1].trim()}`:t}else{if(e)return e;if(a)return a}return"Location not specified"}getMockTenantsForSelection(){return[{id:1,name:"Bangalore Temple Trust",email:"admin@bangaloretemple.com",templeName:"Sri Venkateswara Temple",location:"Bengaluru, Karnataka",status:"active",templesCount:5,imageUrl:null,temple:{name:"Sri Venkateswara Temple",address:"123 Temple Street, Bengaluru",city:"Bengaluru",state:"Karnataka"}},{id:2,name:"Mumbai Temples Association",email:"info@mumbaitemples.org",templeName:"Ganesh Temple",location:"Mumbai, Maharashtra",status:"active",templesCount:8,imageUrl:null,temple:{name:"Ganesh Temple",address:"456 Temple Road, Mumbai",city:"Mumbai",state:"Maharashtra"}},{id:3,name:"Madurai Temple Management",email:"admin@maduraitemples.com",templeName:"Meenakshi Temple",location:"Madurai, Tamil Nadu",status:"active",templesCount:3,imageUrl:null,temple:{name:"Meenakshi Temple",address:"789 Divine Lane, Madurai",city:"Madurai",state:"Tamil Nadu"}},{id:4,name:"Puri Temple Network",email:"contact@puritemples.org",templeName:"Jagannath Temple",location:"Puri, Odisha",status:"pending",templesCount:2,imageUrl:null,temple:{name:"Jagannath Temple",address:"101 Sacred Avenue, Puri",city:"Puri",state:"Odisha"}},{id:5,name:"Chennai Temple Board",email:"board@chennaitemples.org",templeName:"Kapaleeshwarar Temple",location:"Chennai, Tamil Nadu",status:"active",templesCount:6,imageUrl:null,temple:{name:"Kapaleeshwarar Temple",address:"202 Temple Square, Chennai",city:"Chennai",state:"Tamil Nadu"}}]}async getTenantApprovalCounts(){var s;try{console.log("Service: Fetching tenant approval counts...");const e=await c.get(`${this.baseURL}/tenant-approval-count`);return console.log("Service: Tenant counts response:",e),e&&typeof e=="object"?{success:!0,data:{pending:e.pending||0,approved:e.approved||0,rejected:e.rejected||0},message:"Tenant approval counts fetched successfully"}:{success:!1,data:{pending:0,approved:0,rejected:0},message:"Invalid response format for tenant counts"}}catch(e){return console.error("Service: Error fetching tenant approval counts:",e),((s=e.response)==null?void 0:s.status)===404?(console.warn("Tenant count endpoint not found, using mock data"),{success:!0,data:{pending:2,approved:3,rejected:1},message:"Mock tenant counts loaded (API endpoint not available)"}):{success:!1,data:{pending:0,approved:0,rejected:0},message:e.message||"Failed to fetch tenant approval counts"}}}async getTempleApprovalCounts(){var s;try{console.log("Service: Fetching temple approval counts...");const e=await c.get(`${this.baseURL}/temple-approval-count`);return console.log("Service: Temple counts response:",e),e&&typeof e=="object"?{success:!0,data:{pendingApprovals:e.pending_approval||e.pending_approvals||0,activeTemples:e.active_temples||0,rejectedTemples:e.rejected||0,totalUsers:e.total_devotees||e.total_users||0,newThisWeek:e.new_this_week||0},message:"Temple approval counts fetched successfully"}:{success:!1,data:{pendingApprovals:0,activeTemples:0,rejectedTemples:0,totalUsers:0,newThisWeek:0},message:"Invalid response format for temple counts"}}catch(e){return console.error("Service: Error fetching temple approval counts:",e),((s=e.response)==null?void 0:s.status)===404?(console.warn("Temple count endpoint not found, using mock data"),{success:!0,data:{pendingApprovals:5,activeTemples:32,rejectedTemples:3,totalUsers:178,newThisWeek:4},message:"Mock temple counts loaded (API endpoint not available)"}):{success:!1,data:{pendingApprovals:0,activeTemples:0,rejectedTemples:0,totalUsers:0,newThisWeek:0},message:e.message||"Failed to fetch temple approval counts"}}}async getPendingTenants(){var s;try{console.log("Service: Fetching pending tenants...");const e=await c.get(`${this.baseURL}/tenants?status=pending`);return console.log("Service: Raw API response:",e),{success:!0,data:e.pending_tenants||e.data||e||[],message:"Tenants fetched successfully"}}catch(e){return console.error("Service: Error fetching pending tenants:",e),((s=e.response)==null?void 0:s.status)===404?(console.warn("Endpoint not found, using mock data for demonstration"),{success:!0,data:this.getMockPendingTenants(),message:"Mock tenant data loaded (API endpoint not available)"}):{success:!1,data:null,message:e.message||"Failed to fetch pending tenants"}}}async getAllTenants(s={}){var e;try{const a=new URLSearchParams;s.status&&a.append("status",s.status),s.search&&a.append("search",s.search),s.page&&a.append("page",s.page),s.limit&&a.append("limit",s.limit),s.sortBy&&a.append("sortBy",s.sortBy),s.sortOrder&&a.append("sortOrder",s.sortOrder);const t=await c.get(`${this.baseURL}/tenants?${a}`);return Array.isArray(t.data)?{success:!0,data:t.data,pagination:{total:t.data.length},message:"Tenants fetched successfully"}:t.data&&Array.isArray(t.data.tenants)?{success:!0,data:t.data.tenants,pagination:t.data.pagination||{},message:"Tenants fetched successfully"}:t.data&&Array.isArray(t.data.data)?{success:!0,data:t.data.data,pagination:t.data.pagination||{},message:"Tenants fetched successfully"}:{success:!1,data:[],message:"Unexpected API response format"}}catch(a){return console.error("Error fetching all tenants:",a),((e=a.response)==null?void 0:e.status)===404?(console.warn("Endpoint not found, using mock data for demonstration"),{success:!0,data:this.getMockAllTenants(),message:"Mock tenant data loaded (API endpoint not available)"}):{success:!1,data:[],message:a.message||"Failed to fetch tenants"}}}async getTempleadminsForReports(){try{console.log("Service: Fetching temple admins list for reports...");try{const s=await c.get(`${this.baseURL}/tenants/reports`);if(console.log("Service: Enhanced tenants/reports response:",s),s&&(Array.isArray(s.data)||Array.isArray(s))){const e=Array.isArray(s.data)?s.data:Array.isArray(s)?s:[];return console.log("Service: First tenant data from enhanced endpoint:",e[0]),{success:!0,data:e,message:"Temple admins list fetched successfully with temple details"}}}catch{console.warn("Enhanced endpoint not available, trying standard endpoints...")}try{const s=new URLSearchParams({role:"templeadmin",status:"active"}),e=await c.get(`${this.baseURL}/tenants?${s}`);if(console.log("Service: Tenant response for templeadmins:",e),e&&(Array.isArray(e.data)||Array.isArray(e))){const a=Array.isArray(e.data)?e.data:Array.isArray(e)?e:[];for(const t of a){const n=t.id||t.ID;try{const o=await c.get(`${this.baseURL}/tenant-details/${n}`);o&&o.data&&(t.temple_details=o.data,t.temple={name:o.data.temple_name,city:o.data.temple_place,state:o.data.temple_state||""})}catch(o){console.warn(`Could not fetch details for tenant ${n}:`,o)}}return{success:!0,data:a,message:"Temple admins list fetched successfully with supplementary details"}}}catch{console.warn("Could not fetch templeadmins from tenants endpoint, trying alternatives...")}try{const s=await this.getAllTenants();if(s.success&&Array.isArray(s.data))return{success:!0,data:s.data.filter(a=>{var n,o;const t=((n=a.role)==null?void 0:n.roleName)||((o=a.role)==null?void 0:o.RoleName)||"";return t.toLowerCase()==="templeadmin"||t.toLowerCase()==="temple_admin"}),message:"Temple admins filtered from all tenants"}}catch(s){console.warn("Could not fetch templeadmins from all tenants:",s)}return console.warn("No API endpoints available for temple admins, using mock data"),{success:!0,data:this.getMockTenantsWithTempleDetails(),message:"Mock temple admins list loaded (API endpoints not available)"}}catch(s){return console.error("Service: Error fetching temple admins list:",s),console.warn("Temple admins list endpoint not found, using mock data"),{success:!0,data:this.getMockTenantsWithTempleDetails(),message:"Mock temple admins list loaded (API endpoint not available)"}}}async approveTenant(s){var e;try{console.log(`Approving tenant ${s}...`);const a={status:"APPROVED"},t=await c.patch(`${this.baseURL}/tenants/${s}/approval`,a);return console.log("Tenant approval response:",t),{success:!0,data:t,message:"Tenant approved successfully"}}catch(a){return console.error("Error approving tenant:",a),((e=a.response)==null?void 0:e.status)===404?(console.warn("Endpoint not found, simulating successful approval"),this.updateMockTenantStatus(s,"approved"),{success:!0,data:{status:"approved",message:"Tenant approved successfully (mock)"},message:"Tenant approved successfully (mock)"}):{success:!1,data:null,message:a.message||"Failed to approve tenant"}}}async rejectTenant(s,e){var a;try{console.log(`Rejecting tenant ${s}...`);const t={status:"REJECTED",reason:e.reason||e.notes||""},n=await c.patch(`${this.baseURL}/tenants/${s}/approval`,t);return console.log("Tenant rejection response:",n),{success:!0,data:n,message:"Tenant rejected successfully"}}catch(t){return console.error("Error rejecting tenant:",t),((a=t.response)==null?void 0:a.status)===404?(console.warn("Endpoint not found, simulating successful rejection"),this.updateMockTenantStatus(s,"rejected"),{success:!0,data:{status:"rejected",reason:e.reason||e.notes,message:"Tenant rejected successfully (mock)"},message:"Tenant rejected successfully (mock)"}):{success:!1,data:null,message:t.message||"Failed to reject tenant"}}}async getTenantDetails(s){try{const e=await c.get(`${this.baseURL}/tenants/${s}`);return e.data&&e.data.tenant?{success:!0,data:e.data.tenant,temples:e.data.temples||[],message:"Tenant details fetched successfully"}:e.data?{success:!0,data:e.data,temples:e.data.temples||[],message:"Tenant details fetched successfully"}:{success:!1,data:null,message:"Unexpected API response format"}}catch(e){return console.error("Error fetching tenant details:",e),{success:!1,data:null,message:e.message||"Failed to fetch tenant details"}}}async getPendingEntities(s={}){var e,a,t,n;try{console.log("Fetching pending entities from API...");const o=await c.get(`${this.baseURL}/entities`,{params:{status:"PENDING",...s}}),r=(o==null?void 0:o.data)??{};return Array.isArray(r)?{success:!0,data:r,total:r.length,message:"Pending entities fetched successfully"}:Array.isArray(r.pending_entities)?{success:!0,data:r.pending_entities,total:r.pending_entities.length,message:"Pending entities fetched successfully"}:Array.isArray(r.entities)?{success:!0,data:r.entities,total:r.total||r.entities.length,message:"Pending entities fetched successfully"}:Array.isArray(r.data)?{success:!0,data:r.data,total:r.total||r.data.length,message:"Pending entities fetched successfully"}:(console.warn("API returned unexpected data format:",r),{success:!0,data:[],total:0,message:"No pending entities found"})}catch(o){if(console.error("Error fetching pending entities:",o),((e=o.response)==null?void 0:e.status)===404){const r=((a=this.getMockPendingEntities)==null?void 0:a.call(this))||[];return{success:!0,data:r,total:r.length,message:"Mock entities loaded (API endpoint not available)"}}return{success:!1,data:[],message:((n=(t=o.response)==null?void 0:t.data)==null?void 0:n.error)||o.message||"Failed to fetch pending entities"}}}async approveEntity(s,e){var a,t,n,o;try{console.log(`Approving entity ${s}...`);const r={status:"APPROVED",notes:(e==null?void 0:e.notes)||""},l=await c.patch(`${this.baseURL}/entities/${s}/approval`,r);return{success:!0,data:(l==null?void 0:l.data)??null,message:((a=l==null?void 0:l.data)==null?void 0:a.message)||"Entity approved successfully"}}catch(r){return console.error("Error approving entity:",r),((t=r.response)==null?void 0:t.status)===404?(console.warn("Endpoint not found, simulating successful approval"),{success:!0,data:{status:"approved",message:"Entity approved successfully (mock)"},message:"Entity approved successfully (mock)"}):{success:!1,data:null,message:((o=(n=r.response)==null?void 0:n.data)==null?void 0:o.error)||r.message||"Failed to approve entity"}}}async rejectEntity(s,e){var a,t,n,o;try{console.log(`Rejecting entity ${s}...`);const r={status:"REJECTED",reason:(e==null?void 0:e.reason)||(e==null?void 0:e.notes)||""},l=await c.patch(`${this.baseURL}/entities/${s}/approval`,r);return{success:!0,data:(l==null?void 0:l.data)??null,message:((a=l==null?void 0:l.data)==null?void 0:a.message)||"Entity rejected successfully"}}catch(r){return console.error("Error rejecting entity:",r),((t=r.response)==null?void 0:t.status)===404?(console.warn("Endpoint not found, simulating successful rejection"),{success:!0,data:{status:"rejected",reason:(e==null?void 0:e.reason)||(e==null?void 0:e.notes)||"",message:"Entity rejected successfully (mock)"},message:"Entity rejected successfully (mock)"}):{success:!1,data:null,message:((o=(n=r.response)==null?void 0:n.data)==null?void 0:o.error)||r.message||"Failed to reject entity"}}}async getEntitiesWithFilters(s={}){var e,a;try{const t=await c.get(`${this.baseURL}/entities`,{params:s}),n=(t==null?void 0:t.data)??{};return Array.isArray(n)?{success:!0,data:n,total:n.length,message:"Entities fetched"}:Array.isArray(n.entities)?{success:!0,data:n.entities,total:n.total||n.entities.length,message:"Entities fetched"}:Array.isArray(n.data)?{success:!0,data:n.data,total:n.total||n.data.length,message:"Entities fetched"}:{success:!0,data:[],total:0,message:"No entities found"}}catch(t){return{success:!1,data:[],message:((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.error)||t.message||"Failed to fetch entities"}}}async getUserRoles(){try{console.log("Service: Fetching user roles...");const s=await c.get(`${this.baseURL}/user-roles`);return console.log("Service: User roles response:",s),s&&s.data&&Array.isArray(s.data)?{success:!0,data:s.data,message:"User roles fetched successfully"}:Array.isArray(s)?{success:!0,data:s,message:"User roles fetched successfully"}:{success:!1,data:[],message:"Invalid response format for user roles"}}catch(s){return console.error("Service: Error fetching user roles:",s),{success:!1,data:[],message:s.message||"Failed to fetch user roles"}}}async getUsers(s={}){try{console.log("Service: Fetching users...");const e=new URLSearchParams;s.limit&&e.append("limit",s.limit),s.page&&e.append("page",s.page),s.search&&e.append("search",s.search),s.role&&e.append("role",s.role),s.status&&e.append("status",s.status);const a=await c.get(`${this.baseURL}/users?${e}`);return console.log("Service: Users response:",a),a&&a.data&&Array.isArray(a.data)?{success:!0,data:a.data,total:a.total||a.data.length,pagination:{page:a.page||s.page||1,limit:a.limit||s.limit||10,total:a.total||a.data.length},message:"Users fetched successfully"}:Array.isArray(a)?{success:!0,data:a,total:a.length,pagination:{page:s.page||1,limit:s.limit||10,total:a.length},message:"Users fetched successfully"}:{success:!1,data:[],message:"Invalid response format for users"}}catch(e){return console.error("Service: Error fetching users:",e),{success:!1,data:[],message:e.message||"Failed to fetch users"}}}async getUserById(s){try{console.log(`Service: Fetching user ${s}...`);const e=await c.get(`${this.baseURL}/users/${s}`);return console.log("Service: User details response:",e),e&&e.data?{success:!0,data:e.data,message:"User details fetched successfully"}:{success:!1,data:null,message:"Invalid response format for user details"}}catch(e){return console.error("Service: Error fetching user details:",e),{success:!1,data:null,message:e.message||"Failed to fetch user details"}}}async createUser(s){var e,a;try{console.log("Service: Creating user...",s);const t=await c.post(`${this.baseURL}/users`,s);return console.log("Service: Create user response:",t),{success:!0,data:t,message:"User created successfully"}}catch(t){return console.error("Service: Error creating user:",t),{success:!1,data:null,message:((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.error)||t.message||"Failed to create user"}}}async updateUser(s,e){var a,t;try{console.log(`Service: Updating user ${s}...`,e);const n=await c.put(`${this.baseURL}/users/${s}`,e);return console.log("Service: Update user response:",n),{success:!0,data:n,message:"User updated successfully"}}catch(n){return console.error("Service: Error updating user:",n),{success:!1,data:null,message:((t=(a=n.response)==null?void 0:a.data)==null?void 0:t.error)||n.message||"Failed to update user"}}}async updateUserStatus(s,e){var a,t;try{console.log(`Service: Updating user ${s} status to ${e}...`);const n=await c.patch(`${this.baseURL}/users/${s}/status`,{status:e});return console.log("Service: Update user status response:",n),{success:!0,data:n,message:"User status updated successfully"}}catch(n){return console.error("Service: Error updating user status:",n),{success:!1,data:null,message:((t=(a=n.response)==null?void 0:a.data)==null?void 0:t.error)||n.message||"Failed to update user status"}}}async getAssignableTenants(){var s,e;try{console.log("Service: Fetching assignable tenants...");const a=await c.get(`${this.baseURL}/tenants/assignable`);console.log("Service: Assignable tenants response:",a);let t=[];if(Array.isArray(a.data)?t=a.data:a.data&&Array.isArray(a.data.tenants)?t=a.data.tenants:a.data&&a.data.data&&Array.isArray(a.data.data)&&(t=a.data.data),console.log("Service: Raw tenants data:",t),console.log("Service: First tenant sample:",t[0]),t.length>0){const r=t[0];console.log("Service: Available ID fields:",{id:r.id,tenant_id:r.tenant_id,tenantId:r.tenantId,userId:r.userId,user_id:r.user_id,userID:r.userID})}const n=new Map;t.forEach((r,l)=>{let i=r.id??r.tenant_id??r.tenantId??r.userId??r.user_id??r.userID;console.log(`Service: Processing tenant ${l}:`,{originalId:i,tenantName:r.tenantName||r.name,templeName:r.templeName||r.temple_name}),typeof i=="string"&&i.trim()!==""&&(i=Number(i)),(i==null||isNaN(i))&&(console.log(`Service: No valid ID found for tenant ${l}, using index as ID`),i=l+1),n.has(i)?console.log(`Service: Skipped duplicate tenant with ID ${i}`):(n.set(i,{...r,id:i}),console.log(`Service: Added tenant with ID ${i} to map`))});const o=Array.from(n.values());return console.log("Service: Final unique tenants count:",o.length),console.log("Service: Final unique tenants:",o),{success:!0,data:o,message:`Assignable tenants fetched successfully (${o.length} unique tenants)`}}catch(a){return console.error("Service: Error fetching assignable tenants:",a),{success:!1,data:[],message:((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||a.message||"Failed to fetch assignable tenants"}}}async assignUserToTenant(s,e){var a,t,n,o,r;try{console.log(`Service: Assigning user ${s} to tenant ${e}...`);const l={tenantId:Number(e),userId:Number(s)};console.log("Assignment payload:",l);const i=await c.post(`${this.baseURL}/users/assign`,l);return console.log("Service: User assigned to tenant response:",i),{success:!0,data:i.data,message:((a=i.data)==null?void 0:a.message)||"User assigned to tenant successfully"}}catch(l){return console.error("Service: Error assigning user to tenant:",l),{success:!1,data:null,message:((n=(t=l.response)==null?void 0:t.data)==null?void 0:n.message)||((r=(o=l.response)==null?void 0:o.data)==null?void 0:r.error)||l.message||"Failed to assign user to tenant"}}}async searchUserByEmail(s){var e,a,t,n;try{console.log(`Service: Searching for user with email ${s}...`);const o=await c.get(`${this.baseURL}/users/search?email=${encodeURIComponent(s)}`);console.log("Service: User search response:",o);const r=((e=o.data)==null?void 0:e.data)||o.data||o;return r?{success:!0,data:r,message:"User found successfully"}:{success:!1,data:null,message:"User not found"}}catch(o){return console.error("Service: Error searching for user:",o),((a=o.response)==null?void 0:a.status)===404&&s.includes("@")?(console.warn("Endpoint not found, using mock data for demonstration"),{success:!0,data:{id:1,fullName:"John Doe",email:s,role:{id:2,roleName:"tenant"}},message:"Mock user found (API endpoint not available)"}):{success:!1,data:null,message:((n=(t=o.response)==null?void 0:t.data)==null?void 0:n.error)||o.message||"User not found"}}}async resetUserPassword(s,e){var a,t,n;try{console.log(`Service: Resetting password for user ${s}...`);const o=await c.post(`${this.baseURL}/users/${s}/reset-password`,{password:e,sendEmail:!0});return console.log("Service: Password reset response:",o),{success:!0,message:"Password reset successfully. A notification email has been sent to the user."}}catch(o){return console.error("Service: Error resetting password:",o),((a=o.response)==null?void 0:a.status)===404?(console.warn("Endpoint not found, simulating successful password reset"),{success:!0,message:"Password reset successfully (mock). In production, an email would be sent to the user."}):{success:!1,message:((n=(t=o.response)==null?void 0:t.data)==null?void 0:n.error)||o.message||"Failed to reset password"}}}async getDashboardStats(s={}){try{const e=new URLSearchParams;s.startDate&&e.append("startDate",s.startDate),s.endDate&&e.append("endDate",s.endDate),s.period&&e.append("period",s.period),console.log("Fetching dashboard stats with params:",e.toString());const a=await c.get(`${this.baseURL}/dashboard?${e}`);return console.log("Dashboard stats response:",a),a&&typeof a=="object"&&!Array.isArray(a)&&(a.pendingApprovals!==void 0||a.activeTemples!==void 0||a.stats!==void 0)?{success:!0,data:a.stats||a,message:"Dashboard stats fetched successfully"}:{success:!1,data:null,message:"Unexpected API response format or no stats available"}}catch(e){return console.error("Error fetching dashboard stats:",e),{success:!1,data:null,message:e.message||"Failed to fetch dashboard stats"}}}async getSystemStats(s={}){return this.getTempleApprovalCounts()}async getRoles(){try{console.log("Service: Fetching roles...");const s=await c.get(`${this.baseURL}/roles`);return console.log("Service: Roles response:",s),Array.isArray(s)?{success:!0,data:s,message:"Roles fetched successfully"}:(console.warn("Service: API returned a non-array response for roles:",s),{success:!1,data:[],message:"Unexpected API response format for roles"})}catch(s){return console.error("Service: Error fetching roles:",s),{success:!1,data:[],message:s.message||"Failed to fetch roles"}}}async createRole(s){var e,a;try{console.log("Service: Creating new role...",s);const t=await c.post(`${this.baseURL}/roles`,s);return console.log("Service: Create role response:",t),{success:!0,data:t.data,message:"Role created successfully"}}catch(t){return console.error("Service: Error creating role:",t),{success:!1,data:null,message:((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to create role"}}}async updateRole(s,e){var a,t;try{console.log(`Service: Updating role with ID ${s}...`,e);const n=await c.put(`${this.baseURL}/roles/${s}`,e);return console.log("Service: Update role response:",n),{success:!0,data:n.data,message:"Role updated successfully"}}catch(n){return console.error("Service: Error updating role:",n),{success:!1,data:null,message:((t=(a=n.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to update role"}}}async deleteRole(s){var e,a;try{console.log(`Service: Deleting role with ID ${s}...`);const t=await c.delete(`${this.baseURL}/roles/${s}`);return console.log("Service: Delete role response:",t),{success:!0,data:t.data,message:"Role deleted successfully"}}catch(t){return console.error("Service: Error deleting role:",t),{success:!1,data:null,message:((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to delete role"}}}async getRecentActivities(s=10){try{try{const e=await c.get(`${this.baseURL}/activities?limit=${s}`);if(Array.isArray(e))return{success:!0,data:e,message:"Recent activities fetched successfully"};if(e&&Array.isArray(e.activities))return{success:!0,data:e.activities,message:"Recent activities fetched successfully"}}catch(e){return console.warn("Activities endpoint not yet implemented:",e),{success:!0,data:this.getMockActivities(s),message:"Mock activities generated (endpoint not available)"}}return{success:!1,data:[],message:"Unexpected API response format for activities"}}catch(e){return console.error("Error in getRecentActivities:",e),{success:!1,data:[],message:e.message||"Failed to fetch recent activities"}}}async bulkUploadUsers(s){try{console.log("Service: Starting bulk upload of users...",s.length,"users");const e=new FormData,n=[["Full Name","Email","Phone","Password","Role","Status"].join(","),...s.map(l=>[`"${l.full_name||""}"`,`"${l.email||""}"`,`"${l.phone||""}"`,`"${l.password||""}"`,`"${l.role||""}"`,`"${l.status||"active"}"`].join(","))].join(`
`),o=new Blob([n],{type:"text/csv"});e.append("file",o,"bulk_users.csv");const r=await c.post(`${this.baseURL}/users/bulk-upload`,e,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Service: Bulk upload response:",r),r&&r.success!==!1?{success:!0,data:{total_rows:r.total_rows||s.length,success_count:r.success_count||r.totalRows||s.length,failed_count:r.failed_count||r.failedCount||0,errors:r.errors||[]},message:r.message||"Bulk upload completed successfully"}:{success:!1,data:{total_rows:s.length,success_count:0,failed_count:s.length,errors:r.errors||[r.message||"Unknown error"]},message:r.message||"Bulk upload failed"}}catch(e){if(console.error("Service: Error during bulk upload:",e),e.response){const a=e.response.data;return{success:!1,data:{total_rows:s.length,success_count:0,failed_count:s.length,errors:a.errors||[a.message||e.response.statusText]},message:a.message||`Server error: ${e.response.status}`}}else return e.request?{success:!1,data:{total_rows:s.length,success_count:0,failed_count:s.length,errors:["Network error - please check your connection"]},message:"Failed to connect to server"}:{success:!1,data:{total_rows:s.length,success_count:0,failed_count:s.length,errors:[e.message||"Unknown error occurred"]},message:e.message||"Bulk upload failed"}}}getMockPendingTenants(){return this._mockTenants.filter(s=>s.Status==="pending")}getMockAllTenants(){return this._mockTenants}updateMockTenantStatus(s,e){const a=parseInt(s);this._mockTenants=this._mockTenants.map(t=>t.ID===a?{...t,Status:e,UpdatedAt:new Date().toISOString()}:t),console.log(`Mock tenant ${s} status updated to ${e}`)}getMockPendingEntities(){return[{ID:1,Name:"Sri Venkateswara Temple",Description:"Famous temple dedicated to Lord Venkateswara",Type:"Hindu",Address:"123 Temple Street",City:"Bengaluru",State:"Karnataka",Country:"India",Zip:"560001",Phone:"9876543210",Email:"info@svtemple.com",Website:"www.svtemple.com",TenantID:1,Status:"pending",CreatedBy:1,CreatedAt:"2025-07-11T10:00:00Z",UpdatedAt:"2025-07-11T10:00:00Z"},{ID:2,Name:"Ganesh Mandir",Description:"Temple dedicated to Lord Ganesha",Type:"Hindu",Address:"456 Temple Lane",City:"Chennai",State:"Tamil Nadu",Country:"India",Zip:"600001",Phone:"8765432109",Email:"info@ganeshmandir.com",Website:"www.ganeshmandir.com",TenantID:2,Status:"pending",CreatedBy:2,CreatedAt:"2025-07-12T11:30:00Z",UpdatedAt:"2025-07-12T11:30:00Z"}]}getMockAvailableTenants(){return[{id:1,userId:"T001",name:"Sri Krishna Trust",temple:{id:101,name:"Sri Krishna Temple",address:"123 Temple Street, Bengaluru, KA"}},{id:2,userId:"T002",name:"Ganesh Temple Trust",temple:{id:102,name:"Ganesh Temple",address:"456 Mandir Road, Mysore, KA"}},{id:3,userId:"T003",name:"Shiva Temple Trust",temple:{id:103,name:"Shiva Temple",address:"789 Divine Lane, Hassan, KA"}},{id:4,userId:"T004",name:"Lakshmi Temple Association",temple:{id:104,name:"Lakshmi Temple",address:"101 Prosperity Avenue, Mangalore, KA"}},{id:5,userId:"T005",name:"Saraswati Education Trust",temple:{id:105,name:"Saraswati Temple",address:"202 Knowledge Street, Hubli, KA"}}]}getMockActivities(s=10){return[{id:1,type:"approval",description:"Approved temple admin registration",timestamp:new Date(Date.now()-36e5).toISOString()},{id:2,type:"approval",description:"Approved new temple registration",timestamp:new Date(Date.now()-72e5).toISOString()},{id:3,type:"new_application",description:"Created new temple",timestamp:new Date(Date.now()-864e5).toISOString()},{id:4,type:"rejection",description:"Rejected temple admin registration due to incomplete information",timestamp:new Date(Date.now()-1728e5).toISOString()},{id:5,type:"new_application",description:"Received donation of â‚¹5000",timestamp:new Date(Date.now()-2592e5).toISOString()},{id:6,type:"new_application",description:"Created new temple event: Ganesh Chaturthi Celebration",timestamp:new Date(Date.now()-3456e5).toISOString()},{id:7,type:"new_application",description:"Booked seva: Abhishekam",timestamp:new Date(Date.now()-432e6).toISOString()}].slice(0,s)}}const T=new h;export{T as s};
