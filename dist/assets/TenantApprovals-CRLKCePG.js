import{_ as he,h as u,i as t,j as b,t as i,w as K,k as Te,F as Q,l as X,G as f,v as we,n as H,r as x,c as D,D as Z,s as Ae,L as $,e as _e,o as g}from"./index-Bqden_Qr.js";import{s as ee}from"./superadmin.service-ymcF6AST.js";const ke={name:"TenantApprovals",emits:["updated"],setup(te,{emit:o}){const L=x(!0),s=x([]),m=x([]),p=_e(),C=x(!1),v=x(!0),a=x(!1),y=x(""),k=x(!1),N=x(null),U=x(""),V=x(!1),A=x(""),h=x(1),S=x(5),_=e=>{if(!e)return"pending";let n=e.status||e.Status||e.approval_status||e.approvalStatus||e.tenant_status||e.user_status||"";return n=String(n).toLowerCase().trim(),!n||n==="null"||n==="undefined"?"pending":{approved:"approved",active:"approved",accepted:"approved",confirm:"approved",confirmed:"approved",approved_active:"approved",rejected:"rejected",declined:"rejected",denied:"rejected",cancelled:"rejected",refused:"rejected",inactive:"rejected",pending:"pending",pending_approval:"pending",waiting:"pending",submitted:"pending",under_review:"pending",new:"pending"}[n]||"pending"},I=e=>_(e)==="pending",E=e=>_(e)==="approved",R=e=>_(e)==="rejected",F=D(()=>{const e=Array.isArray(m.value)?m.value:[];if(e.length===0)return 0;const n=e.filter(r=>{const l=I(r);return v.value&&console.log(`Tenant ${r.id||"unknown"}: status="${_(r)}", isPending=${l}`),l}).length;return v.value&&console.log(`ðŸŸ¡ PENDING COUNT: ${n} out of ${e.length} total tenants`),n}),O=D(()=>{const e=Array.isArray(m.value)?m.value:[];if(e.length===0)return 0;const n=e.filter(r=>{const l=E(r);return v.value&&console.log(`Tenant ${r.id||"unknown"}: status="${_(r)}", isApproved=${l}`),l}).length;return v.value&&console.log(`ðŸŸ¢ APPROVED COUNT: ${n} out of ${e.length} total tenants`),n}),z=D(()=>{const e=Array.isArray(m.value)?m.value:[];if(e.length===0)return 0;const n=e.filter(r=>{const l=R(r);return v.value&&console.log(`Tenant ${r.id||"unknown"}: status="${_(r)}", isRejected=${l}`),l}).length;return v.value&&console.log(`ðŸ”´ REJECTED COUNT: ${n} out of ${e.length} total tenants`),n}),T=D(()=>{const e=Array.isArray(m.value)?m.value:[];if(!A.value||A.value===""||A.value==="all")return v.value&&console.log(`ðŸ“‹ SHOWING ALL TENANTS: ${e.length}`),e;let n=[];switch(A.value.toLowerCase()){case"pending":n=e.filter(r=>I(r));break;case"approved":n=e.filter(r=>E(r));break;case"rejected":n=e.filter(r=>R(r));break;default:n=e}return v.value&&console.log(`ðŸ“‹ FILTERED TENANTS (${A.value}): ${n.length} out of ${e.length}`),n}),se=(e,n,r="Not provided")=>{if(!e)return r;if(e.temple_details&&e.temple_details[n])return e.temple_details[n];if(e[n])return e[n];const l=[n,n.toLowerCase(),n.toUpperCase(),n.replace(/_([a-z])/g,(d,c)=>c.toUpperCase()),n.charAt(0).toUpperCase()+n.slice(1)];for(const d of l)if(e[d])return e[d];return r},oe=e=>{if(!e)return"No additional details provided.";if(e.temple_details&&e.temple_details.temple_description)return e.temple_details.temple_description;const n=["temple_description","templeDescription","TempleDescription","description","Description"];for(const r of n)if(e[r])return e[r];return"No additional details provided."},J=e=>{e&&(console.log("=== TENANT DEBUG ==="),console.log("Full tenant object:",e),console.log("Temple details object:",e.temple_details),e.temple_details&&(console.log("Temple name:",e.temple_details.temple_name),console.log("Temple place:",e.temple_details.temple_place),console.log("Temple address:",e.temple_details.temple_address),console.log("Temple phone:",e.temple_details.temple_phone_no),console.log("Temple description:",e.temple_details.temple_description)),console.log("Available keys on tenant:",Object.keys(e)),e.temple_details&&console.log("Available keys on temple_details:",Object.keys(e.temple_details)),console.log("=================="))},ne=D(()=>{const e=Array.isArray(T.value)?T.value:[],n=(h.value-1)*S.value,r=n+S.value;return e.slice(n,r)}),j=D(()=>{const e=Array.isArray(T.value)?T.value:[];return Math.ceil(e.length/S.value)||1}),re=D(()=>(Array.isArray(T.value)?T.value:[]).length===0?0:(h.value-1)*S.value+1),ae=D(()=>{const e=Array.isArray(T.value)?T.value:[];return Math.min(h.value*S.value,e.length)}),le=D(()=>{const n=[];if(j.value<=5)for(let r=1;r<=j.value;r++)n.push(r);else{n.push(1);let r=Math.max(2,h.value-1),l=Math.min(j.value-1,h.value+1);h.value<=2&&(l=3),h.value>=j.value-1&&(r=j.value-2),r>2&&n.push("...");for(let d=r;d<=l;d++)n.push(d);l<j.value-1&&n.push("..."),j.value>1&&n.push(j.value)}return n}),M=e=>e?e.full_name?e.full_name:e.FullName?e.FullName:e.fullName?e.fullName:e.name?e.name:e.Name?e.Name:e.email?e.email.split("@")[0]:e.Email?e.Email.split("@")[0]:e.id||e.ID?`User ${e.id||e.ID}`:"Unknown Tenant":"Unknown Tenant",G=e=>e?e.email?e.email:e.Email?e.Email:e.email_address?e.email_address:e.EmailAddress?e.EmailAddress:"No email provided":"No email provided",ie=e=>{if(!e)return"T";const n=M(e);if(n&&n!=="Unknown Tenant"&&n.length>0)return n.charAt(0).toUpperCase();const r=G(e);return r&&r!=="No email provided"&&r.length>0?r.charAt(0).toUpperCase():"T"},de=e=>{const n=_({status:e});return{pending:"bg-yellow-100 text-yellow-800 border border-yellow-200",approved:"bg-green-100 text-green-800 border border-green-200",rejected:"bg-red-100 text-red-800 border border-red-200"}[n]||"bg-gray-100 text-gray-800 border border-gray-200"},ce=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}},ue=e=>{e!=="..."&&(h.value=e)},ge=(e=null)=>{e!==null&&(A.value=e),h.value=1,console.log(`Applied filter: ${A.value}`),console.log(`Filtered tenants count: ${T.value.length}`)},pe=e=>{N.value=e,console.log("Opening details for tenant:",e),v.value&&J(e),V.value=!0},me=()=>{Y(N.value),V.value=!1},W=()=>{console.log("=== ALL TENANT STATUSES ===");const e=Array.isArray(m.value)?m.value:[];e.forEach((n,r)=>{const l=n.status||n.Status||"undefined",d=_(n),c=I(n),w=E(n),B=R(n);console.log(`Tenant ${r+1} (ID: ${n.id||n.ID||"unknown"}):`,{name:M(n),rawStatus:l,normalizedStatus:d,isPending:c,isApproved:w,isRejected:B})}),console.log(`
SUMMARY:
        Total: ${e.length}
        Pending: ${F.value}
        Approved: ${O.value}
        Rejected: ${z.value}
        Sum: ${F.value+O.value+z.value}`),console.log("==========================")},P=async()=>{L.value=!0;try{console.log("ðŸ”„ Loading ALL tenant data from multiple endpoints...");let e=[];const n=["/api/v1/superadmin/tenants","/api/v1/superadmin/tenants?status=pending","/api/v1/superadmin/tenants?status=approved","/api/v1/superadmin/tenants?status=active","/api/v1/superadmin/tenants?status=rejected"];for(const r of n)try{console.log(`ðŸ”— Trying endpoint: ${r}`);const l=await fetch(r,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(l.ok){const d=await l.json();let c=[];d&&d.data&&Array.isArray(d.data)?c=d.data:Array.isArray(d)?c=d:d&&Array.isArray(d.tenants)&&(c=d.tenants),c.length>0&&(console.log(`âœ… Got ${c.length} tenants from ${r}`),c.forEach(w=>{const B=w.id||w.ID;B&&!e.find(q=>(q.id||q.ID)===B)&&e.push(w)}))}else console.log(`âŒ Endpoint ${r} returned ${l.status}`)}catch(l){console.error(`âŒ Error with endpoint ${r}:`,l)}if(e.length===0){console.log("ðŸ”§ Trying service methods as fallback...");try{const r=await ee.getAllTenants();if(r&&r.success&&r.data)Array.isArray(r.data)&&(e=r.data,console.log(`âœ… Loaded ${e.length} tenants from service`));else{const l=await ee.getPendingTenants();l&&l.success&&l.data&&Array.isArray(l.data)&&(e=l.data,console.log(`âš ï¸ Loaded ${e.length} pending tenants only`))}}catch(r){console.error("âŒ Error with service methods:",r)}}m.value=[...e],s.value=[...e],await $(),console.log(`ðŸ“Š FINAL RESULT: ${e.length} total tenants loaded`),console.log(`ðŸ“Š STATUS BREAKDOWN:
          - Pending: ${e.filter(r=>I(r)).length}
          - Approved: ${e.filter(r=>E(r)).length}
          - Rejected: ${e.filter(r=>R(r)).length}`),e.length>0?p.success(`Loaded ${e.length} total tenants`):p.warning("No tenant data found")}catch(e){console.error("âŒ Error in loadAllTenants:",e),m.value=[],s.value=[],p.error("Error loading tenant data")}finally{L.value=!1}},fe=async()=>{await P()},ve=async()=>{y.value="Loading API debug information...",a.value=!0;try{const e=[];e.push(`==== TENANT DATA DEBUG ====
`);const n=["/api/v1/superadmin/tenants","/api/v1/superadmin/tenants?status=pending","/api/v1/superadmin/tenants?status=approved","/api/v1/superadmin/tenants?status=active","/api/v1/superadmin/tenants?status=rejected"];for(const r of n){e.push(`
Testing endpoint: ${r}`);try{const l=await fetch(r,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(e.push(`Response status: ${l.status} ${l.statusText}`),l.ok){const d=await l.json();let c=0;d&&d.data&&Array.isArray(d.data)?(c=d.data.length,e.push(`Data structure: { data: [${c} items] }`),c>0&&(e.push(`Sample item keys: ${Object.keys(d.data[0]).join(", ")}`),e.push(`Sample status values: ${d.data.slice(0,3).map(w=>w.status||w.Status||"undefined").join(", ")}`))):Array.isArray(d)?(c=d.length,e.push(`Data structure: [${c} items]`),c>0&&(e.push(`Sample item keys: ${Object.keys(d[0]).join(", ")}`),e.push(`Sample status values: ${d.slice(0,3).map(w=>w.status||w.Status||"undefined").join(", ")}`))):e.push(`Unexpected data structure keys: ${Object.keys(d).join(", ")}`)}else{const d=await l.text();e.push(`Error: ${d}`)}}catch(l){e.push(`Error: ${l.message}`)}}e.push(`
==== COMPONENT STATE ====`),e.push(`Total tenants loaded: ${m.value.length}`),e.push(`Pending count: ${F.value}`),e.push(`Approved count: ${O.value}`),e.push(`Rejected count: ${z.value}`),e.push(`Current filter: ${A.value}`),e.push(`Filtered tenants: ${T.value.length}`),m.value.length>0&&(e.push(`
==== SAMPLE TENANT STATUS ANALYSIS ====`),m.value.slice(0,5).forEach((r,l)=>{const d=r.status||r.Status||"undefined",c=_(r);e.push(`Tenant ${l+1}: raw="${d}" -> normalized="${c}"`)})),y.value=e.join(`
`)}catch(e){y.value=`Error running debug: ${e.message}`}},be=async e=>{if(!e){p.error("No tenant selected for testing");return}y.value=`Testing API call for tenant ${e.id||e.ID||"unknown"}...`,a.value=!0;try{const n=[];n.push(`Testing API approval for tenant:
${JSON.stringify(e,null,2)}
`);const r=e.id||e.ID||e.user_id||e.userId;if(!r){n.push("ERROR: No tenant ID found in tenant object!"),y.value=n.join(`
`);return}n.push(`Using tenant ID: ${r}`),n.push(`
Testing direct PATCH call to approve tenant...`);try{const l=localStorage.getItem("auth_token");n.push(`Auth token available: ${!!l}`);const d=await fetch(`/api/v1/superadmin/tenants/${r}/approval`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({status:"APPROVED"})});if(n.push(`API Response Status: ${d.status} ${d.statusText}`),d.ok){const c=await d.json();n.push(`API Response Data: ${JSON.stringify(c,null,2)}`),n.push(`
SUCCESS: Direct API call worked! The backend endpoint is functional.`),p.success("Test API call successful!"),await P()}else{const c=await d.text();n.push(`Error response: ${c}`)}}catch(l){n.push(`API Error: ${l.message}`)}y.value=n.join(`
`)}catch(n){y.value=`Error running API test: ${n.message}`}},Y=async e=>{if(!e){p.error("Cannot approve: Missing tenant");return}const n=e.id||e.ID;if(!n){p.error("Cannot approve: Missing tenant ID");return}C.value=!0,console.log(`ðŸ”„ Attempting to approve tenant ${n}`);try{const r=await fetch(`/api/v1/superadmin/tenants/${n}/approval`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({status:"APPROVED"})});if(r.ok){const l=await r.json();console.log("âœ… Approval successful:",l),p.success(`Tenant ${M(e)} approved successfully`),await P(),o("updated")}else{console.error("âŒ Approval failed with status:",r.status);const l=await r.text();console.error("Error response:",l),p.error(`Failed to approve tenant: ${r.statusText}`)}}catch(r){console.error("âŒ Error in approval process:",r),p.error("Error approving tenant: "+(r.message||"Unknown error"))}finally{C.value=!1}},xe=e=>{if(!e){p.error("Cannot reject: Missing tenant");return}if(!(e.id||e.ID)){p.error("Cannot reject: Missing tenant ID");return}N.value=e,U.value="",k.value=!0},ye=async()=>{const e=N.value;if(!e){p.error("Cannot reject: Missing tenant"),k.value=!1;return}const n=e.id||e.ID;if(!n){p.error("Cannot reject: Missing tenant ID"),k.value=!1;return}if(!U.value.trim()){p.warning("Please provide a rejection reason");return}C.value=!0;try{const r=await fetch(`/api/v1/superadmin/tenants/${n}/approval`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({status:"REJECTED",reason:U.value})});if(r.ok){const l=await r.json();console.log("âœ… Rejection successful:",l),p.success(`Tenant ${M(e)} rejected successfully`),k.value=!1,await P(),o("updated")}else{console.error("âŒ Rejection failed with status:",r.status);const l=await r.text();console.error("Error response:",l),p.error(`Failed to reject tenant: ${r.statusText}`)}}catch(r){console.error("âŒ Error in rejection process:",r),p.error("Error rejecting tenant: "+(r.message||"Unknown error"))}finally{C.value=!1}};return Z(A,(e,n)=>{e!==n&&(console.log(`Status filter changed from ${n} to ${e}`),h.value=1)}),Z(m,e=>{console.log(`ðŸ”„ allTenants changed: ${e.length} tenants`),v.value&&e.length>0&&$(()=>{W()})},{deep:!0}),Ae(()=>{console.log("ðŸš€ Component mounted, loading tenants..."),P()}),{loading:L,tenants:s,allTenants:m,pendingCount:F,approvedCount:O,rejectedCount:z,statusFilter:A,currentPage:h,itemsPerPage:S,filteredTenants:T,paginatedTenants:ne,totalPages:j,paginationStart:re,paginationEnd:ae,displayedPageNumbers:le,getStatusBadgeClass:de,formatDate:ce,loadTenants:fe,loadAllTenants:P,handleApprove:Y,handleRejectClick:xe,getTenantName:M,getTenantEmail:G,getTenantInitial:ie,goToPage:ue,isStatusPending:I,isStatusApproved:E,isStatusRejected:R,applyFilters:ge,isProcessing:C,showRejectModal:k,selectedTenant:N,rejectReason:U,confirmReject:ye,showDetailsModal:V,handleViewDetails:pe,handleApproveFromDetails:me,getTempleDetail:se,getTempleDescription:oe,debugTenantDetails:J,debugMode:v,debugTenantData:ve,logAllTenantStatuses:W,normalizeStatus:_,testApprovalApi:be,showApiDebugModal:a,apiDebugInfo:y}}},je={class:"space-y-6"},De={key:0,class:"bg-gray-100 p-4 rounded-lg mb-4 text-xs font-mono overflow-auto max-h-40"},Ce={key:0},Se={class:"mt-2 flex gap-2"},Pe={class:"flex flex-wrap gap-3"},Ne={class:"bg-yellow-50 border border-yellow-200 rounded-xl px-4 py-3 text-center min-w-[100px] flex-1"},Ie={class:"text-2xl font-bold text-yellow-800"},Ee={class:"bg-green-50 border border-green-200 rounded-xl px-4 py-3 text-center min-w-[100px] flex-1"},Re={class:"text-2xl font-bold text-green-800"},Me={class:"bg-red-50 border border-red-200 rounded-xl px-4 py-3 text-center min-w-[100px] flex-1"},Le={class:"text-2xl font-bold text-red-800"},Ue={class:"flex flex-col sm:flex-row justify-between gap-3"},Fe={class:"flex gap-3"},Oe={key:1,class:"flex justify-center items-center py-12"},ze={key:2,class:"space-y-4"},Be={class:"p-6"},Ve={key:0,class:"bg-gray-100 p-2 mb-3 rounded text-xs"},He={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-4"},Je={class:"flex items-start gap-4"},Ge={class:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center flex-shrink-0"},We={class:"text-indigo-600 font-semibold text-lg"},Ye={class:"flex-1 min-w-0"},qe={class:"text-lg font-semibold text-gray-900 font-roboto"},Ke={class:"text-sm text-gray-600"},Qe={class:"flex flex-col sm:flex-row items-start sm:items-center gap-3"},Xe={class:"text-xs text-gray-500"},Ze={class:"flex flex-col sm:flex-row gap-3"},$e=["onClick"],et={key:0,class:"flex flex-col sm:flex-row gap-3 flex-1"},tt=["onClick","disabled"],st=["onClick","disabled"],ot=["onClick"],nt={class:"flex flex-col sm:flex-row items-center justify-between bg-white p-4 rounded-xl shadow-sm border border-gray-200"},rt={class:"text-sm text-gray-700 mb-3 sm:mb-0"},at={class:"font-medium"},lt={class:"font-medium"},it={class:"font-medium"},dt={class:"flex space-x-2"},ct=["disabled"],ut={class:"flex space-x-1"},gt=["onClick"],pt=["disabled"],mt={key:3,class:"text-center py-12"},ft={class:"mt-2 text-sm text-gray-500"},vt={key:4,class:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center"},bt={class:"bg-white rounded-xl p-6 w-full max-w-md mx-4"},xt={key:0,class:"bg-gray-100 p-2 mb-3 rounded text-xs"},yt={class:"mb-4"},ht={class:"font-medium"},Tt={class:"flex justify-end gap-3"},wt=["disabled"],At=["disabled"],_t={key:5,class:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center"},kt={class:"bg-white rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-auto"},jt={class:"flex justify-between items-center border-b border-gray-200 pb-4 mb-5"},Dt={key:0,class:"space-y-5"},Ct={class:"flex items-center gap-4 mb-4"},St={class:"h-16 w-16 rounded-full bg-indigo-100 flex items-center justify-center flex-shrink-0"},Pt={class:"text-indigo-600 font-semibold text-2xl"},Nt={class:"text-xl font-semibold text-gray-900"},It={class:"text-gray-600"},Et={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Rt={class:"space-y-4"},Mt={class:"border-b border-gray-100 pb-3"},Lt={class:"text-base text-gray-900 mt-1"},Ut={class:"border-b border-gray-100 pb-3"},Ft={class:"text-base text-gray-900 mt-1"},Ot={class:"border-b border-gray-100 pb-3"},zt={class:"text-base text-gray-900 mt-1"},Bt={class:"border-b border-gray-100 pb-3"},Vt={class:"text-base text-gray-900 mt-1"},Ht={class:"space-y-4"},Jt={class:"border-b border-gray-100 pb-3"},Gt={class:"text-base text-gray-900 mt-1"},Wt={class:"border-b border-gray-100 pb-3"},Yt={class:"text-base text-gray-900 mt-1"},qt={class:"border-b border-gray-100 pb-3"},Kt={class:"text-base text-gray-900 mt-1"},Qt={class:"border-b border-gray-100 pb-3"},Xt={class:"text-base text-gray-900 mt-1"},Zt={class:"mt-5 border-t border-gray-100 pt-4"},$t={class:"text-base text-gray-900 bg-gray-50 p-4 rounded-lg"},es={key:0,class:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded"},ts={class:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200"},ss={key:0},os=["disabled"],ns={key:6,class:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 flex items-center justify-center"},rs={class:"bg-white rounded-xl p-6 w-full max-w-3xl mx-4 max-h-[80vh] overflow-auto"},as={class:"bg-gray-100 p-4 rounded font-mono text-xs overflow-auto whitespace-pre"},ls={class:"mt-4 flex justify-end"};function is(te,o,L,s,m,p){var C,v;return g(),u("div",je,[o[52]||(o[52]=t("div",{class:"border-b border-gray-200 pb-4"},[t("h1",{class:"text-2xl font-bold text-gray-900 font-roboto"},"Tenant Approvals"),t("p",{class:"mt-1 text-sm text-gray-500"},"Review and manage tenant registration requests")],-1)),s.debugMode?(g(),u("div",De,[o[16]||(o[16]=t("div",{class:"mb-2 font-bold"},"Debug Information:",-1)),s.selectedTenant?(g(),u("div",Ce,"Selected Tenant: ID="+i(s.selectedTenant.id||s.selectedTenant.ID)+", Name="+i(s.getTenantName(s.selectedTenant)),1)):b("",!0),t("div",null,"Tenant Count: "+i(Array.isArray(s.allTenants)?s.allTenants.length:0),1),t("div",null,"Pending: "+i(s.pendingCount)+", Approved: "+i(s.approvedCount)+", Rejected: "+i(s.rejectedCount),1),t("div",Se,[t("button",{onClick:o[0]||(o[0]=(...a)=>s.debugTenantData&&s.debugTenantData(...a)),class:"px-3 py-1 bg-gray-200 rounded text-xs"},"Run API Debug"),t("button",{onClick:o[1]||(o[1]=(...a)=>s.logAllTenantStatuses&&s.logAllTenantStatuses(...a)),class:"px-3 py-1 bg-blue-200 rounded text-xs"},"Log All Statuses")])])):b("",!0),t("div",Pe,[t("div",Ne,[t("div",Ie,i(s.pendingCount),1),o[17]||(o[17]=t("div",{class:"text-xs text-yellow-600 font-medium"},"Pending",-1))]),t("div",Ee,[t("div",Re,i(s.approvedCount),1),o[18]||(o[18]=t("div",{class:"text-xs text-green-600 font-medium"},"Approved",-1))]),t("div",Me,[t("div",Le,i(s.rejectedCount),1),o[19]||(o[19]=t("div",{class:"text-xs text-red-600 font-medium"},"Rejected",-1))])]),t("div",Ue,[t("div",Fe,[K(t("select",{"onUpdate:modelValue":o[2]||(o[2]=a=>s.statusFilter=a),class:"px-3 py-2 bg-white border border-gray-300 rounded-lg text-sm w-full sm:w-auto",onChange:o[3]||(o[3]=(...a)=>s.applyFilters&&s.applyFilters(...a))},[...o[20]||(o[20]=[t("option",{value:""},"View All",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"approved"},"Approved",-1),t("option",{value:"rejected"},"Rejected",-1)])],544),[[Te,s.statusFilter]]),t("button",{onClick:o[4]||(o[4]=a=>s.debugMode=!s.debugMode),class:"px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg text-sm"},i(s.debugMode?"Hide Debug":"Debug Mode"),1)]),t("button",{onClick:o[5]||(o[5]=(...a)=>s.loadTenants&&s.loadTenants(...a)),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm"}," Refresh Data ")]),s.loading?(g(),u("div",Oe,[...o[21]||(o[21]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):b("",!0),!s.loading&&Array.isArray(s.filteredTenants)&&s.filteredTenants.length>0?(g(),u("div",ze,[(g(!0),u(Q,null,X(s.paginatedTenants,(a,y)=>(g(),u("div",{key:a.id||a.ID||y,class:"bg-white rounded-xl shadow-md border border-gray-200 hover:shadow-lg transition-all duration-200"},[t("div",Be,[s.debugMode?(g(),u("div",Ve,[o[22]||(o[22]=t("span",{class:"font-bold"},"ID:",-1)),f(" "+i(a.id||a.ID||"Not available")+" | ",1),o[23]||(o[23]=t("span",{class:"font-bold"},"Raw Status:",-1)),f(" "+i(a.status||a.Status||"Not available")+" | ",1),o[24]||(o[24]=t("span",{class:"font-bold"},"Normalized:",-1)),f(" "+i(s.normalizeStatus(a))+" | ",1),o[25]||(o[25]=t("span",{class:"font-bold"},"Is Pending:",-1)),f(" "+i(s.isStatusPending(a)),1)])):b("",!0),t("div",He,[t("div",Je,[t("div",Ge,[t("span",We,i(s.getTenantInitial(a)),1)]),t("div",Ye,[t("h3",qe,i(s.getTenantName(a)),1),t("p",Ke,i(s.getTenantEmail(a)),1)])]),t("div",Qe,[t("span",{class:H([s.getStatusBadgeClass(a.status||a.Status),"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium"])},i(a.status||a.Status||"pending"),3),t("span",Xe," Applied: "+i(s.formatDate(a.created_at||a.CreatedAt)),1)])]),t("div",Ze,[t("button",{onClick:k=>s.handleViewDetails(a),class:"flex-1 sm:flex-none px-6 py-2 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 text-sm font-medium rounded-xl transition-all duration-200 flex items-center justify-center gap-2"},[...o[26]||(o[26]=[t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),f(" View Details ",-1)])],8,$e),s.isStatusPending(a)?(g(),u("div",et,[t("button",{onClick:k=>s.handleApprove(a),class:"flex-1 sm:flex-none px-6 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-xl transition-all duration-200 flex items-center justify-center gap-2",disabled:s.isProcessing},[o[27]||(o[27]=t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),f(" "+i(s.isProcessing?"Processing...":"Approve"),1)],8,tt),t("button",{onClick:k=>s.handleRejectClick(a),class:"flex-1 sm:flex-none px-6 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-xl transition-all duration-200 flex items-center justify-center gap-2",disabled:s.isProcessing},[o[28]||(o[28]=t("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)),f(" "+i(s.isProcessing?"Processing...":"Reject"),1)],8,st),s.debugMode?(g(),u("button",{key:0,onClick:k=>s.testApprovalApi(a),class:"flex-1 sm:flex-none px-6 py-2 bg-gray-600 text-white text-sm font-medium rounded-xl flex items-center justify-center gap-2"}," Test API Call ",8,ot)):b("",!0)])):b("",!0)])])]))),128)),t("div",nt,[t("div",rt,[o[29]||(o[29]=f(" Showing ",-1)),t("span",at,i(s.paginationStart),1),o[30]||(o[30]=f(" to ",-1)),t("span",lt,i(s.paginationEnd),1),o[31]||(o[31]=f(" of ",-1)),t("span",it,i(Array.isArray(s.filteredTenants)?s.filteredTenants.length:0),1),o[32]||(o[32]=f(" results ",-1))]),t("div",dt,[t("button",{onClick:o[6]||(o[6]=a=>s.currentPage--),disabled:s.currentPage===1,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,ct),t("div",ut,[(g(!0),u(Q,null,X(s.displayedPageNumbers,a=>(g(),u("button",{key:a,onClick:y=>s.goToPage(a),class:H(["inline-flex items-center px-3 py-2 border text-sm font-medium rounded-md",s.currentPage===a?"border-indigo-500 bg-indigo-50 text-indigo-600":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50"])},i(a),11,gt))),128))]),t("button",{onClick:o[7]||(o[7]=a=>s.currentPage++),disabled:s.currentPage===s.totalPages,class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm font-medium rounded-md bg-white text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,pt)])])])):s.loading?b("",!0):(g(),u("div",mt,[o[33]||(o[33]=t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),o[34]||(o[34]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"No tenant applications found",-1)),t("p",ft,i(s.statusFilter?`No tenants with "${s.statusFilter}" status found`:"Try refreshing or checking back later"),1)])),s.showRejectModal?(g(),u("div",vt,[t("div",bt,[o[39]||(o[39]=t("h3",{class:"text-lg font-semibold mb-4"},"Reject Tenant",-1)),s.debugMode?(g(),u("div",xt,[t("div",null,[o[35]||(o[35]=t("span",{class:"font-bold"},"Selected Tenant ID:",-1)),f(" "+i(((C=s.selectedTenant)==null?void 0:C.id)||((v=s.selectedTenant)==null?void 0:v.ID)),1)]),t("div",null,[o[36]||(o[36]=t("span",{class:"font-bold"},"Selected Tenant Name:",-1)),f(" "+i(s.getTenantName(s.selectedTenant)),1)])])):b("",!0),t("p",yt,[o[37]||(o[37]=f("Please provide a reason for rejecting ",-1)),t("span",ht,i(s.selectedTenant?s.getTenantName(s.selectedTenant):""),1),o[38]||(o[38]=f(":",-1))]),K(t("textarea",{"onUpdate:modelValue":o[8]||(o[8]=a=>s.rejectReason=a),class:"w-full border border-gray-300 rounded-lg p-3 mb-4 min-h-[100px] focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter rejection reason..."},null,512),[[we,s.rejectReason]]),t("div",Tt,[t("button",{onClick:o[9]||(o[9]=a=>s.showRejectModal=!1),class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg",disabled:s.isProcessing}," Cancel ",8,wt),t("button",{onClick:o[10]||(o[10]=(...a)=>s.confirmReject&&s.confirmReject(...a)),disabled:!s.rejectReason.trim()||s.isProcessing,class:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg disabled:opacity-50"},i(s.isProcessing?"Processing...":"Reject"),9,At)])])])):b("",!0),s.showDetailsModal?(g(),u("div",_t,[t("div",kt,[t("div",jt,[o[41]||(o[41]=t("h3",{class:"text-xl font-bold text-gray-900"},"Tenant Details",-1)),t("button",{onClick:o[11]||(o[11]=a=>s.showDetailsModal=!1),class:"text-gray-400 hover:text-gray-600"},[...o[40]||(o[40]=[t("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),s.selectedTenant?(g(),u("div",Dt,[t("div",null,[t("div",Ct,[t("div",St,[t("span",Pt,i(s.getTenantInitial(s.selectedTenant)),1)]),t("div",null,[t("h4",Nt,i(s.getTenantName(s.selectedTenant)),1),t("p",It,i(s.getTenantEmail(s.selectedTenant)),1)])]),t("div",Et,[t("div",Rt,[t("div",Mt,[o[42]||(o[42]=t("div",{class:"text-sm font-medium text-gray-500"},"Status",-1)),t("div",Lt,[t("span",{class:H([s.getStatusBadgeClass(s.selectedTenant.status||s.selectedTenant.Status),"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium"])},i(s.selectedTenant.status||s.selectedTenant.Status||"pending"),3)])]),t("div",Ut,[o[43]||(o[43]=t("div",{class:"text-sm font-medium text-gray-500"},"Application Date",-1)),t("div",Ft,i(s.formatDate(s.selectedTenant.created_at||s.selectedTenant.CreatedAt)),1)]),t("div",Ot,[o[44]||(o[44]=t("div",{class:"text-sm font-medium text-gray-500"},"Phone Number",-1)),t("div",zt,i(s.selectedTenant.phone||s.selectedTenant.Phone||"Not provided"),1)]),t("div",Bt,[o[45]||(o[45]=t("div",{class:"text-sm font-medium text-gray-500"},"User ID",-1)),t("div",Vt,i(s.selectedTenant.id||s.selectedTenant.ID||"Not available"),1)])]),t("div",Ht,[t("div",Jt,[o[46]||(o[46]=t("div",{class:"text-sm font-medium text-gray-500"},"Temple Name",-1)),t("div",Gt,i(s.getTempleDetail(s.selectedTenant,"temple_name")),1)]),t("div",Wt,[o[47]||(o[47]=t("div",{class:"text-sm font-medium text-gray-500"},"Temple Location",-1)),t("div",Yt,i(s.getTempleDetail(s.selectedTenant,"temple_place")),1)]),t("div",qt,[o[48]||(o[48]=t("div",{class:"text-sm font-medium text-gray-500"},"Temple Address",-1)),t("div",Kt,i(s.getTempleDetail(s.selectedTenant,"temple_address")),1)]),t("div",Qt,[o[49]||(o[49]=t("div",{class:"text-sm font-medium text-gray-500"},"Temple Phone",-1)),t("div",Xt,i(s.getTempleDetail(s.selectedTenant,"temple_phone_no")),1)])])]),t("div",Zt,[o[50]||(o[50]=t("div",{class:"text-sm font-medium text-gray-500 mb-2"},"Temple Description",-1)),t("div",$t,i(s.getTempleDescription(s.selectedTenant)),1)]),s.debugMode?(g(),u("div",es,[t("button",{onClick:o[12]||(o[12]=a=>s.debugTenantDetails(s.selectedTenant)),class:"px-3 py-1 bg-yellow-200 hover:bg-yellow-300 text-yellow-800 rounded text-sm"}," Debug Temple Details ")])):b("",!0)])])):b("",!0),t("div",ts,[t("button",{onClick:o[13]||(o[13]=a=>s.showDetailsModal=!1),class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg"}," Close "),s.isStatusPending(s.selectedTenant)?(g(),u("div",ss,[t("button",{onClick:o[14]||(o[14]=(...a)=>s.handleApproveFromDetails&&s.handleApproveFromDetails(...a)),class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg disabled:opacity-50",disabled:s.isProcessing},i(s.isProcessing?"Processing...":"Approve"),9,os)])):b("",!0)])])])):b("",!0),s.showApiDebugModal?(g(),u("div",ns,[t("div",rs,[o[51]||(o[51]=t("h3",{class:"text-lg font-semibold mb-4"},"API Debug Information",-1)),t("div",as,i(s.apiDebugInfo),1),t("div",ls,[t("button",{onClick:o[15]||(o[15]=a=>s.showApiDebugModal=!1),class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg"}," Close ")])])])):b("",!0)])}const us=he(ke,[["render",is]]);export{us as default};
