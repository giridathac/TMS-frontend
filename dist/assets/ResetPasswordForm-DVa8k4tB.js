import{C as M,r,c as V,D,s as I,h as l,i as e,j as U,t as u,p as T,w as N,v as A,n as c,G as j,A as F,o as n}from"./index-Bqden_Qr.js";import{s as B}from"./superadmin.service-ymcF6AST.js";const L={class:"container mx-auto px-4 py-8"},S={class:"bg-white rounded-lg shadow-md p-6 max-w-2xl mx-auto"},Z={key:0,class:"flex justify-center py-8"},q={key:1,class:"text-center py-8"},G={class:"text-red-500 text-lg mb-4"},H={key:2},J={class:"mb-6 p-4 bg-gray-50 rounded-md"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},O={class:"font-medium"},Q={class:"font-medium"},W={class:"font-medium"},X={class:"mt-2"},Y={class:"text-xs space-y-1 ml-5 list-disc"},$={key:0,class:"mt-1 text-sm text-red-600"},ee={class:"pt-2"},se=["disabled"],te={key:0},ae={key:1},oe={key:0,class:"fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-md shadow-lg z-50 flex items-center"},ie={__name:"ResetPasswordForm",setup(re){const y=F(),p=M().params.userId,v=r(null),f=r(!0),i=r(""),a=r(""),d=r(""),o=r(""),g=r(!1),w=r(!1),b=r(""),C=async()=>{f.value=!0,i.value="";try{const t=await B.getUserById(p);t.success&&t.data?v.value=t.data:i.value="Unable to load user details. User may not exist."}catch(t){console.error("Error fetching user details:",t),i.value="Error loading user details. Please try again."}finally{f.value=!1}},h=()=>a.value.length<8?(o.value="Password must be at least 8 characters long",!1):/[A-Z]/.test(a.value)?/[a-z]/.test(a.value)?/\d/.test(a.value)?a.value!==d.value?(o.value="Passwords do not match",!1):(o.value="",!0):(o.value="Password must contain at least one number",!1):(o.value="Password must contain at least one lowercase letter",!1):(o.value="Password must contain at least one uppercase letter",!1),R=V(()=>a.value&&d.value&&a.value===d.value&&a.value.length>=8&&/[A-Z]/.test(a.value)&&/[a-z]/.test(a.value)&&/\d/.test(a.value)),E=async()=>{if(h())try{g.value=!0;const t=await B.resetUserPassword(p,a.value);t.success?(b.value="Password updated successfully! An email has been sent to the user.",w.value=!0,setTimeout(()=>{w.value=!1,y.push({name:"ResetPassword"})},3e3)):o.value=t.message||"Failed to reset password. Please try again."}catch(t){console.error("Error resetting password:",t),o.value="An unexpected error occurred. Please try again."}finally{g.value=!1}},P=()=>{y.push({name:"ResetPassword"})},z=t=>{var s,m;return t?(s=t.role)!=null&&s.role_name?t.role.role_name:(m=t.role)!=null&&m.roleName?t.role.roleName:t.roleName?t.roleName:typeof t.role=="string"?t.role:"User":"User"};return D([a,d],()=>{a.value&&d.value?h():o.value=""}),I(()=>{p?C():(i.value="No user ID provided. Please go back and try again.",f.value=!1)}),(t,s)=>{var m,_,k;return n(),l("div",L,[e("div",{class:"flex items-center mb-6"},[e("button",{onClick:P,class:"mr-4 p-2 rounded-full hover:bg-gray-100"},[...s[2]||(s[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)])]),s[3]||(s[3]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Reset User Password",-1))]),e("div",S,[f.value?(n(),l("div",Z,[...s[4]||(s[4]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-700"},null,-1)])])):i.value?(n(),l("div",q,[e("div",G,u(i.value),1),e("button",{onClick:P,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"}," Go Back ")])):(n(),l("div",H,[e("div",J,[s[8]||(s[8]=e("h2",{class:"text-lg font-medium text-gray-800 mb-2"},"User Information",-1)),e("div",K,[e("div",null,[s[5]||(s[5]=e("p",{class:"text-sm text-gray-500"},"Name",-1)),e("p",O,u(((m=v.value)==null?void 0:m.full_name)||((_=v.value)==null?void 0:_.fullName)),1)]),e("div",null,[s[6]||(s[6]=e("p",{class:"text-sm text-gray-500"},"Email",-1)),e("p",Q,u((k=v.value)==null?void 0:k.email),1)]),e("div",null,[s[7]||(s[7]=e("p",{class:"text-sm text-gray-500"},"Role",-1)),e("p",W,u(z(v.value)),1)])])]),e("form",{onSubmit:T(E,["prevent"]),class:"space-y-6"},[e("div",null,[s[10]||(s[10]=e("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 mb-1"},"New Password",-1)),N(e("input",{type:"password",id:"newPassword","onUpdate:modelValue":s[0]||(s[0]=x=>a.value=x),class:c(["w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":o.value}]),required:"",minlength:"8"},null,2),[[A,a.value]]),e("div",X,[s[9]||(s[9]=e("div",{class:"text-xs text-gray-500 mb-2"},"Password must contain:",-1)),e("ul",Y,[e("li",{class:c(a.value.length>=8?"text-green-600":"text-gray-500")}," At least 8 characters ",2),e("li",{class:c(/[A-Z]/.test(a.value)?"text-green-600":"text-gray-500")}," At least one uppercase letter ",2),e("li",{class:c(/[a-z]/.test(a.value)?"text-green-600":"text-gray-500")}," At least one lowercase letter ",2),e("li",{class:c(/\d/.test(a.value)?"text-green-600":"text-gray-500")}," At least one number ",2)])])]),e("div",null,[s[11]||(s[11]=e("label",{for:"confirmPassword",class:"block text-sm font-medium text-gray-700 mb-1"},"Confirm Password",-1)),N(e("input",{type:"password",id:"confirmPassword","onUpdate:modelValue":s[1]||(s[1]=x=>d.value=x),class:c(["w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":o.value}]),required:""},null,2),[[A,d.value]]),o.value?(n(),l("p",$,u(o.value),1)):U("",!0)]),e("div",ee,[e("button",{type:"submit",class:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",disabled:!R.value||g.value},[g.value?(n(),l("span",te,"Updating Password...")):(n(),l("span",ae,"Update Password"))],8,se)])],32)]))]),w.value?(n(),l("div",oe,[s[12]||(s[12]=e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),j(" "+u(b.value),1)])):U("",!0)])}}};export{ie as default};
